## 一般单目标有约束优化问题

$$
\begin{matrix}
    \min_x f(x), \\
    s.t. f_i(x) \leq b_i.
\end{matrix}
$$

---

# **凸优化基础：集合与组合**

## **1. 集合的基本类型**

### **1.1 仿射集 (Affine Set)**

- **定义**：集合 $ C \subseteq \mathbb{R}^n $ 是仿射集，若对任意 $ x, y \in C $ 和 $ \lambda \in \mathbb{R} $，有 $ \lambda x + (1-\lambda)y \in C $。
- **几何意义**：集合中任意两点的直线仍在集合内。
- **例子**：直线、平面、超平面；线性方程组 $ Ax = b $ 的解集。

### **1.2 凸集 (Convex Set)**

- **定义**：集合 $ C \subseteq \mathbb{R}^n $ 是凸集，若对任意 $ x, y \in C $ 和 $ \lambda \in [0,1] $，有 $ \lambda x + (1-\lambda)y \in C $。
- **几何意义**：集合中任意两点的线段仍在集合内。
- **例子**：球体、立方体；非负象限 $ \mathbb{R}^n_+ $。

### **1.3 凸锥集 (Convex Cone)**

- **定义**：集合 $ C \subseteq \mathbb{R}^n $ 是凸锥集，若对任意 $ x, y \in C $ 和 $ \lambda, \mu \geq 0 $，有 $ \lambda x + \mu y \in C $。
- **几何意义**：集合对非负线性组合封闭。
- **例子**：原点为顶点的锥体；半正定矩阵集合。

---

## **2. 组合的类型**

### **2.1 线性组合 (Linear Combination)**

- **定义**：$ \theta_1 x_1 + \theta_2 x_2 + \dots + \theta_k x_k $，其中 $ \theta_i \in \mathbb{R} $。

### **2.2 仿射组合 (Affine Combination)**

- **定义**：线性组合 + 系数和为 1（即 $ \sum_{i=1}^k \theta_i = 1 $）。
- **性质**：仿射集的元素可表示为集合中点的仿射组合。

### **2.3 凸组合 (Convex Combination)**

- **定义**：仿射组合 + 系数非负（即 $ \theta_i \geq 0 $）。
- **性质**：凸集的元素可表示为集合中点的凸组合。

### **2.4 凸锥组合 (Conic Combination)**

- **定义**：线性组合 + 系数非负（即 $ \theta_i \geq 0 $）。
- **性质**：凸锥集的元素可表示为集合中点的凸锥组合。

---

## **3. 包 (Hull) 的概念**

### **3.1 仿射包 (Affine Hull)**

- **定义**：包含集合 $ C $ 的最小仿射集。
- **数学表达**：

$$
\text{aff}(C) = \left\{ \sum_{i=1}^k \theta_i x_i \mid x_i \in C, \sum_{i=1}^k \theta_i = 1, k \in \mathbb{N} \right\}
$$

- **例子**：单点集的仿射包是其自身；两个点的仿射包是过它们的直线。

### **3.2 凸包 (Convex Hull)**

- **定义**：包含集合 $ C $ 的最小凸集。
- **数学表达**：

$$
\text{conv}(C) = \left\{ \sum_{i=1}^k \theta_i x_i \mid x_i \in C, \theta_i \geq 0, \sum_{i=1}^k \theta_i = 1 \right\}
$$

- **例子**：平面上五边形的凸包是其本身；离散点集的凸包是包含这些点的最小凸多边形。

### **3.3 凸锥包 (Conic Hull)**

- **定义**：包含集合 $ C $ 的最小凸锥集。
- **数学表达**：

$$
\text{cone}(C) = \left\{ \sum_{i=1}^k \theta_i x_i \mid x_i \in C, \theta_i \geq 0 \right\}
$$

- **例子**：原点和某一点的凸锥包是从原点出发的射线。

---

## **4. 关键关系与图示**

- **包含关系**：仿射集 ⊂ 凸集 ⊂ 凸锥集（当包含原点时）。
- **维恩图**：用三个嵌套圆表示三种集合的包含关系。
- **几何示例**：
  - 仿射集：超平面 $ x_1 + x_2 = 1 $。
  - 凸集：单位圆盘 $ \{x \mid \|x\|_2 \leq 1\} $。
  - 凸锥集：非负象限 $ \mathbb{R}^2_+ $。

---

# **凸优化讲义：几种重要的凸集**

---

## **1. 超平面与半空间**

### **1.1 超平面 (Hyperplane)**

- **定义**：形如 $ \{ x \in \mathbb{R}^n \mid a^\top x = b \} $ 的集合，其中 $ a \in \mathbb{R}^n \setminus \{0\} $，$ b \in \mathbb{R} $。
- **几何意义**：$ \mathbb{R}^n $ 中的一个 $ n-1 $ 维子空间。
- **凸性**：仿射集 ⇒ 凸集。
- **例子**：
  - 在 $ \mathbb{R}^2 $ 中：直线 $ 2x_1 + 3x_2 = 6 $。
  - 在 $ \mathbb{R}^3 $ 中：平面 $ x_1 - x_2 + 2x_3 = 4 $。

### **1.2 半空间 (Halfspace)**

- **定义**：形如 $ \{ x \in \mathbb{R}^n \mid a^\top x \leq b \} $ 或 $ \{ x \in \mathbb{R}^n \mid a^\top x \geq b \} $ 的集合。
- **几何意义**：超平面将空间分为两部分，半空间是其中一侧的所有点。
- **凸性**：凸集（但非仿射集）。
- **例子**：
  - 在 $ \mathbb{R}^2 $ 中：$ 2x_1 + x_2 \leq 5 $ 定义了一个半平面。
- **应用**：线性不等式约束的可行域。

---

## **2. 欧几里得球与椭球**

### **2.1 欧几里得球 (Euclidean Ball)**

- **定义**：

  $$
  B(x_c, r) = \left\{ x \in \mathbb{R}^n \mid \|x - x_c\|_2 \leq r \right\},
  $$

  其中 $ x_c $ 是球心，$ r \geq 0 $ 是半径。
- **凸性**：凸集（任意两点间的线段完全在球内）。
- **例子**：单位球 $ B(0, 1) = \{ x \mid x_1^2 + x_2^2 + \dots + x_n^2 \leq 1 \} $。

### **2.2 椭球 (Ellipsoid)**

- **定义**：

  $$
  \mathcal{E} = \left\{ x \in \mathbb{R}^n \mid (x - x_c)^\top P^{-1} (x - x_c) \leq 1 \right\},
  $$

  其中 $ P \succ 0 $ 为对称正定矩阵，$ x_c $ 是椭球中心。
- **几何意义**：通过矩阵 $ P $ 对单位球进行仿射变换（缩放/旋转）得到的集合。
- **凸性**：凸集。
- **例子**：当 $ P = \text{diag}(a_1^2, a_2^2) $ 时，椭球退化为 $ \mathbb{R}^2 $ 中的标准椭圆。

---

## **3. 多面体 (Polyhedron)**

### **定义**

- 有限个线性不等式和等式定义的集合：

  $$
  \mathcal{P} = \left\{ x \in \mathbb{R}^n \mid Ax \leq b, \, Cx = d \right\},
  $$

  其中 $ A \in \mathbb{R}^{m \times n}, C \in \mathbb{R}^{p \times n} $，$ b \in \mathbb{R}^m, d \in \mathbb{R}^p $。

### **几何意义**

- 多个半空间和超平面的交集。
- **关键性质**：
  - 凸集（半空间和超平面均为凸集，凸集的交集仍为凸集）。
  - 可行域的常见形式（如线性规划问题）。

### **例子**

1. 三维空间中的立方体：$ |x_1| \leq 1, \, |x_2| \leq 1, \, |x_3| \leq 1 $。
2. 单纯形（特殊多面体）：
   $ x \geq 0, \, \sum_{i=1}^n x_i = 1 $。

---

## **4. 范数球与范数锥**

### **4.1 范数球 (Norm Ball)**

- **定义**：对任意范数 $ \|\cdot\| $，集合

  $$
  \{ x \in \mathbb{R}^n \mid \|x - x_c\| \leq r \}
  $$

  是凸集（由范数的三角不等式保证）。
- **例子**：

  - $ \ell_1 $-范数球：菱形（二维下）。
  - $ \ell_\infty $-范数球：正方形（二维下）。

### **4.2 范数锥 (Norm Cone)**

- **定义**：
  $$
  \mathcal{C} = \left\{ (x, t) \in \mathbb{R}^n \times \mathbb{R} \mid \|x\| \leq t \right\}.
  $$
- **凸性**：凸集（由范数齐次性和三角不等式保证）。
- **例子**：
  - 二阶锥（欧几里得范数锥）：$ \|x\|_2 \leq t $，用于二次规划。

---

## **5. 半正定锥 (Positive Semidefinite Cone)**

### **定义**

- 所有 $ n \times n $ 半正定矩阵的集合：

  $$
  \mathbb{S}^n_+ = \left\{ X \in \mathbb{S}^n \mid X \succeq 0 \right\},
  $$

  其中 $ \mathbb{S}^n $ 为对称矩阵空间，$ X \succeq 0 $ 表示 $ X $ 半正定。

### **性质**

- **凸性**：凸集（若 $ A \succeq 0, B \succeq 0 $，则 $ \theta A + (1-\theta) B \succeq 0 $）。
- **应用**：半定规划（SDP）、矩阵优化问题。

---

## **6. 凸集的重要性总结**

1. **建模能力**：凸集可描述许多实际问题的可行域（如资源限制、物理约束）。
2. **优化性质**：凸集上的优化问题（凸优化）具有全局最优性、对偶性等良好性质。
3. **运算封闭性**：凸集在交集、仿射变换、直积等操作下仍保持凸性。

---

---

# **凸集的运算：交集与保凸性**

---

## **1. 凸集的交集**

### **1.1 基本定理**

- **定理**：任意多个凸集的交集仍是凸集。
  - 形式化描述：设 $ \{C_i\}_{i \in I} $ 为一族凸集，则 $ C = \bigcap_{i \in I} C_i $ 仍为凸集。
- **证明思路**：
  对任意 $ x, y \in C $ 和 $ \lambda \in [0,1] $，因 $ x, y $ 属于每个 $ C_i $，由 $ C_i $ 的凸性知 $ \lambda x + (1-\lambda)y \in C_i $ 对所有 $ i \in I $ 成立，故 $ \lambda x + (1-\lambda)y \in C $。

### **1.2 几何意义**

- 通过多个凸集的“共同约束”构造新的凸集。
- **关键应用**：多面体是有限个半空间和超平面的交集，因此是凸集。

### **1.3 例子**

1. **多面体**：$ \mathcal{P} = \{x \mid Ax \leq b\} $，是多个半空间 $ a_i^\top x \leq b_i $ 的交集。
2. **单位球与半空间的交集**：$ B(0,1) \cap \{x \mid x_1 \geq 0\} $ 是右半单位球，仍为凸集。
3. **半正定锥的交集**：
   $ \mathbb{S}^n_+ \cap \{X \mid \text{tr}(X) = 1\} $ 是凸集（迹为1的半正定矩阵集合）。

---

## **2. 其他保凸运算**

### **2.1 仿射变换 (Affine Transformation)**

- **定义**：对凸集 $ C \subseteq \mathbb{R}^n $，仿射函数 $ f(x) = Ax + b $（$ A \in \mathbb{R}^{m \times n}, b \in \mathbb{R}^m $）的像与原像保持凸性。
  - **像的凸性**：若 $ C $ 凸，则 $ f(C) = \{Ax + b \mid x \in C\} $ 凸。
  - **原像的凸性**：若 $ D \subseteq \mathbb{R}^m $ 凸，则 $ f^{-1}(D) = \{x \mid Ax + b \in D\} $ 凸。
- **例子**：
  - 平移：将球心从原点移至 $ x_c $。
  - 缩放：将椭球 $ \mathcal{E} $ 通过矩阵 $ P $ 进行线性变换。

### **2.2 直积 (Cartesian Product)**

- **定义**：设 $ C \subseteq \mathbb{R}^n $、$ D \subseteq \mathbb{R}^m $ 为凸集，则直积

  $$
  C \times D = \{(x,y) \mid x \in C, y \in D\}
  $$

  是 $ \mathbb{R}^{n+m} $ 中的凸集。
- **例子**：
  $ [0,1] \times [0,1] $ 是二维单位正方形，为凸集。

### **2.3 透视函数 (Perspective Function)**

- **定义**：对 $ C \subseteq \mathbb{R}^n \times \mathbb{R}_+ $，透视函数 $ P(x,t) = x/t $ 的像保持凸性（当 $ t > 0 $ 时）。
  - 若 $ C $ 凸，则 $ P(C) = \{x/t \mid (x,t) \in C, t > 0\} $ 凸。
- **应用**：将带齐次性的集合（如锥）投影到低维空间。

### **2.4 线性分式函数 (Linear-Fractional Function)**

- **定义**：形如 $ f(x) = \frac{Ax + b}{c^\top x + d} $ 的函数，定义域为 $ \{x \mid c^\top x + d > 0\} $。
  - 若 $ C $ 凸，则 $ f(C) $ 凸。
- **例子**：将多面体映射为另一多面体。

---

## **3. 保凸运算的应用**

### **3.1 构建复杂凸集**

- **步骤**：通过基本凸集（如半空间、球）的交集、仿射变换等运算生成复杂可行域。
  - **例**：多面体 $ \mathcal{P} = \{x \mid Ax \leq b\} $ 是半空间的交集。
  - **例**：椭球是单位球经仿射变换后的像。

### **3.2 优化问题建模**

- **线性规划 (LP)**：多面体约束 $ Ax \leq b $ 是凸集。
- **半定规划 (SDP)**：半正定锥 $ \mathbb{S}^n_+ $ 与仿射约束的交集。

### **3.3 机器学习中的应用**

- **支持向量机 (SVM)**：分类器的间隔区域是半空间的交集。
- **矩阵补全**：半正定锥与观测约束的交集。

---

## **4. 保凸性的直观理解**

- **几何视角**：保凸运算不破坏“线段内点属于集合”的性质。
- **代数视角**：运算对应的不等式/等式约束保持线性或凸性。

---

---

# **凸函数的定义与扩展**

---

## **1. 凸函数的定义**

### **1.1 基本定义**

设函数 $ f: \mathbb{R}^n \to \mathbb{R} $，定义域 $ \text{dom}(f) $ 为凸集。
若对任意 $ x, y \in \text{dom}(f) $ 和 $ \lambda \in [0, 1] $，满足：

$$
f(\lambda x + (1-\lambda) y) \leq \lambda f(x) + (1-\lambda) f(y),
$$

则称 $ f $ 为**凸函数**。

#### **几何意义**

- 函数图像上任意两点间的线段位于图像上方（如图1）。
- 凸函数的“碗状”形状确保了局部最小值即全局最小值。

---

### **1.2 严格凸函数**

若不等式对所有 $ x \neq y $ 和 $ \lambda \in (0,1) $ **严格成立**：

$$
f(\lambda x + (1-\lambda) y) < \lambda f(x) + (1-\lambda) f(y),
$$

则称 $ f $ 为**严格凸函数**。

#### **关键性质**

- 严格凸函数至多有一个全局最小值。

---

### **1.3 凹函数与仿射函数**

- **凹函数**：若 $ -f $ 是凸函数。
- **仿射函数**：同时是凸和凹的函数，形如 $ f(x) = a^\top x + b $。

---

## **2. 凸函数的判定条件**

### **2.1 一阶条件（可微函数）**

若 $ f $ 可微，则 $ f $ 是凸函数当且仅当：

$$
f(y) \geq f(x) + \nabla f(x)^\top (y - x), \quad \forall x, y \in \text{dom}(f).
$$

- **几何解释**：切线（或超平面）位于函数图像下方。

---

### **2.2 二阶条件（二次可微函数）**

若 $ f $ 二次可微，则 $ f $ 是凸函数当且仅当：

$$
\nabla^2 f(x) \succeq 0, \quad \forall x \in \text{dom}(f),
$$

即 Hessian 矩阵半正定。

#### **例子**

1. 二次函数 $ f(x) = \frac{1}{2}x^\top Q x + b^\top x + c $：
   - 凸性条件为 $ Q \succeq 0 $。
2. 指数函数 $ f(x) = e^{ax} $：
   - 二阶导 $ f''(x) = a^2 e^{ax} \geq 0 $，故为凸函数。

---

## **3. 凸函数的扩展与变体**

### **3.1 强凸函数 (Strongly Convex)**

若存在常数 $ \mu > 0 $，使得：

$$
f(y) \geq f(x) + \nabla f(x)^\top (y - x) + \frac{\mu}{2} \|y - x\|^2, \quad \forall x, y \in \text{dom}(f).
$$

- **等价条件**：Hessian 矩阵满足 $ \nabla^2 f(x) \succeq \mu I $。
- **性质**：强凸函数有唯一全局最小值，且优化算法收敛速度更快。

---

### **3.2 拟凸函数 (Quasiconvex Function)**

若对任意 $ \alpha \in \mathbb{R} $，**下水平集**

$$
S_\alpha = \{x \in \text{dom}(f) \mid f(x) \leq \alpha\}
$$

均为凸集，则称 $ f $ 为拟凸函数。

- **注**：凸函数必为拟凸函数，但反之不成立。
- **例子**：$ f(x) = \sqrt{|x|} $ 是拟凸但非凸函数。

---

### **3.3 对数凸函数 (Log-Convex Function)**

若 $ f(x) > 0 $ 且 $ \log f(x) $ 是凸函数，则称 $ f $ 为对数凸函数。

- **性质**：对数凸函数在乘积和幂运算下保持对数凸性。
- **例子**：高斯函数 $ f(x) = e^{-x^2} $。

---

### **3.4 凸函数的扩展值延伸 (Extended-Value Extension)**

为简化分析，常将凸函数 $ f $ 的定义域外点赋值为 $ +\infty $，即：

$$
\tilde{f}(x) = 
\begin{cases} 
f(x), & x \in \text{dom}(f), \\
+\infty, & \text{其他}.
\end{cases}
$$

- **作用**：统一处理约束优化问题（如将约束隐式包含在目标函数中）。

---

## **4. 凸函数的重要例子**

### **4.1 典型凸函数**

1. **线性函数**：$ f(x) = a^\top x + b $。
2. **范数**：任意向量范数（如 $ \|x\|_1 $、$ \|x\|_2 $）。
3. **指数函数**：$ f(x) = e^{ax} $。
4. **负熵**：$ f(x) = x \log x $（定义域 $ x > 0 $）。

---

### **4.2 非典型例子**

1. **最大值函数**：$ f(x) = \max\{x_1, x_2, \dots, x_n\} $。
   - 凸性验证：利用 $ \max $ 运算的凸性。
2. **二次分式函数**：$ f(x) = \frac{\|Ax + b\|^2}{c^\top x + d} $（定义域 $ c^\top x + d > 0 $）。
   - 在特定条件下为凸函数。

---

## **5. 凸函数在优化中的意义**

1. **全局最优性**：凸函数的局部最小值即全局最小值。
2. **高效算法**：梯度下降、牛顿法等在凸函数上收敛性有保障。
3. **对偶理论**：凸函数与凸集的对偶性支撑强对偶性成立。

---

## **附：关键结论**

- **凸函数是凸优化的核心**：其性质保证了优化问题的可解性与算法效率。
- **扩展类别丰富了应用场景**：拟凸、对数凸等函数在经济学、统计学中广泛应用。

---

# **常见函数的凸性分析**

---

## **1. 线性函数**

### **定义**

形如 $ f(x) = a^\top x + b $，其中 $ a \in \mathbb{R}^n $，$ b \in \mathbb{R} $。

### **凸性**

- **既是凸函数也是凹函数**（仿射函数）。
- **验证**：
  - 对任意 $ x, y $ 和 $ \lambda \in [0,1] $，满足：
    $$
    f(\lambda x + (1-\lambda)y) = \lambda f(x) + (1-\lambda)f(y).
    $$

---

## **2. 二次函数**

### **定义**

形如 $ f(x) = \frac{1}{2}x^\top Q x + b^\top x + c $，其中 $ Q \in \mathbb{S}^n $（对称矩阵）。

### **凸性条件**

- **当且仅当** $ Q \succeq 0 $（半正定矩阵）。
- **验证**：
  - 计算 Hessian 矩阵：$ \nabla^2 f(x) = Q $.
  - 检查 $ Q $ 的特征值是否非负。

### **例子**

1. $ f(x) = x_1^2 + x_2^2 $（凸，因 $ Q = I \succ 0 $）。
2. $ f(x) = x_1^2 - x_2^2 $（非凸，因 $ Q $ 有负特征值）。

---

## **3. 指数函数**

### **定义**

单变量形式：$ f(x) = e^{ax} $，多变量可推广为 $ f(x) = e^{a^\top x} $。

### **凸性**

- **凸函数**（对任意 $ a \in \mathbb{R}^n $）。
- **验证**：
  - 二阶导数（单变量）：$ f''(x) = a^2 e^{ax} > 0 $.
  - 多变量 Hessian：$ \nabla^2 f(x) = a a^\top e^{a^\top x} \succeq 0 $.

---

## **4. 对数函数**

### **定义**

单变量形式：$ f(x) = -\log(x) $，定义域 $ x > 0 $。

### **凸性**

- **凸函数**。
- **验证**：
  - 二阶导数：$ f''(x) = \frac{1}{x^2} > 0 $.

---

## **5. 范数函数**

### **定义**

向量范数 $ f(x) = \|x\| $，如 $ \|x\|_1 $、$ \|x\|_2 $、$ \|x\|_\infty $。

### **凸性**

- **凸函数**（所有范数均满足三角不等式和齐次性）。
- **验证**：
  - 对任意 $ x, y $ 和 $ \lambda \in [0,1] $，利用范数的三角不等式：
    $$
    \|\lambda x + (1-\lambda)y\| \leq \lambda \|x\| + (1-\lambda)\|y\|.
    $$

---

## **6. 最大值函数**

### **定义**

$ f(x) = \max\{x_1, x_2, \dots, x_n\} $.

### **凸性**

- **凸函数**。
- **验证**：
  - 对任意 $ x, y $ 和 $ \lambda \in [0,1] $，有：
    $$
    f(\lambda x + (1-\lambda)y) \leq \lambda f(x) + (1-\lambda)f(y).
    $$
  - 因为最大值运算的线性组合不超过各分量的线性组合的最大值。

---

## **7. 分式函数**

### **定义**

形如 $ f(x) = \frac{g(x)}{h(x)} $，需定义在 $ h(x) > 0 $ 的区域。

### **凸性条件**

- **特殊情况**：若 $ g(x) $ 凸，$ h(x) $ 凹且正，则 $ f(x) $ 凸（需通过二阶导数或组合规则验证）。
- **例子**：
  - $ f(x, y) = \frac{x^2}{y} $（定义域 $ y > 0 $）是凸函数。
    - **验证**：Hessian 矩阵半正定。

---

## **8. 负熵函数**

### **定义**

单变量：$ f(x) = x \log x $（定义域 $ x > 0 $），多变量推广为 $ f(x) = \sum_{i=1}^n x_i \log x_i $。

### **凸性**

- **凸函数**。
- **验证**：
  - 二阶导数（单变量）：$ f''(x) = \frac{1}{x} > 0 $.
  - 多变量 Hessian 为对角矩阵，对角元 $ \frac{1}{x_i} > 0 $.

---

## **9. 逻辑函数（Logistic Function）**

### **定义**

单变量：$ f(x) = \log(1 + e^{x}) $.

### **凸性**

- **凸函数**。
- **验证**：
  - 二阶导数：$ f''(x) = \frac{e^x}{(1 + e^x)^2} > 0 $.

---

## **10. 指示函数（Indicator Function）**

### **定义**

对凸集 $ C $，指示函数定义为：

$$
I_C(x) = 
\begin{cases} 
0, & x \in C, \\
+\infty, & \text{否则}.
\end{cases}
$$

### **凸性**

- **凸函数**当且仅当 $ C $ 是凸集。
- **应用**：将约束优化问题转化为无约束问题。

---

## **11. 分段线性函数**

### **定义**

形如 $ f(x) = \max\{a_1^\top x + b_1, \dots, a_k^\top x + b_k\} $。

### **凸性**

- **凸函数**（多个仿射函数的最大值）。
- **验证**：利用最大值函数的凸性。

---

## **12. 幂函数**

### **定义**

单变量：$ f(x) = |x|^p $，其中 $ p \geq 1 $。

### **凸性**

- **当 $ p \geq 1 $ 时凸**，$ 0 < p < 1 $ 时非凸。
- **验证**：
  - 二阶导数：$ f''(x) = p(p-1)|x|^{p-2} $，当 $ p \geq 1 $ 时非负。

---

## **总结与对比**

| **函数类型**  | **凸性**         | **判定方法** |
| ------------------- | ---------------------- | ------------------ |
| 线性函数            | 凸且凹                 | 直接验证定义       |
| 二次函数            | $ Q \succeq 0 $ 时凸 | Hessian 矩阵半正定 |
| 指数函数            | 凸                     | 二阶导数正定       |
| 对数函数            | 凸（定义域内）         | 二阶导数正定       |
| 范数                | 凸                     | 三角不等式         |
| 最大值函数          | 凸                     | 最大值运算保凸     |
| 分式函数$ x^2/y $ | 凸（$ y > 0 $）      | Hessian 半正定     |
| 负熵函数            | 凸                     | 二阶导数正定       |
| 逻辑函数            | 凸                     | 二阶导数正定       |
| 指示函数            | 凸当且仅当集合凸       | 集合的凸性         |
| 幂函数$ |x|^p $   | $ p \geq 1 $ 时凸    | 二阶导数非负       |

---

# **函数的凸性与保凸运算**

---

## **1. 函数凸性的判定**
### **1.1 基本定义回顾**
函数 $ f: \mathbb{R}^n \to \mathbb{R} $ 是凸函数，若其定义域 $ \text{dom}(f) $ 为凸集，且对任意 $ x, y \in \text{dom}(f) $ 和 $ \lambda \in [0,1] $，满足：  
$$
f(\lambda x + (1-\lambda)y) \leq \lambda f(x) + (1-\lambda)f(y).
$$

### **1.2 判定方法**
1. **一阶条件**（可微函数）：  
   $$
   f(y) \geq f(x) + \nabla f(x)^\top (y - x), \quad \forall x, y \in \text{dom}(f).
   $$
2. **二阶条件**（二次可微函数）：  
   $$
   \nabla^2 f(x) \succeq 0, \quad \forall x \in \text{dom}(f).
   $$

---

## **2. 保持凸性的基本运算**
### **2.1 非负加权和**
- **定理**：若 $ f_1, f_2, \dots, f_k $ 是凸函数，$ \alpha_1, \alpha_2, \dots, \alpha_k \geq 0 $，则  
  $$
  f(x) = \sum_{i=1}^k \alpha_i f_i(x)
  $$  
  仍为凸函数。
- **例子**：  
  $ f(x) = 2x^2 + 3e^x $ 是凸函数（二次函数和指数函数的非负加权和）。

---

### **2.2 逐点最大值 (Pointwise Maximum)**
- **定理**：若 $ f_1, f_2, \dots, f_k $ 是凸函数，则  
  $$
  f(x) = \max\{f_1(x), f_2(x), \dots, f_k(x)\}
  $$  
  仍为凸函数。
- **几何解释**：多个凸函数的上包络（upper envelope）保持凸性。
- **例子**：  
  $ f(x) = \max\{x, -x\} = |x| $ 是凸函数。

---

### **2.3 仿射变换复合**
- **定理**：若 $ f: \mathbb{R}^n \to \mathbb{R} $ 是凸函数，则对仿射映射 $ y = Ax + b $，函数  
  $$
   g(x) = f(Ax + b)
  $$  
  仍为凸函数。
- **例子**：  
  $ f(x) = \|Ax + b\|_2 $ 是凸函数（范数的仿射复合）。

---

### **2.4 函数复合 (Composition)**
#### **(1) 标量复合**
- **定理**：设 $ h: \mathbb{R} \to \mathbb{R} $ 凸且非递减，$ g: \mathbb{R}^n \to \mathbb{R} $ 凸，则  
  $$
  f(x) = h(g(x))
  $$  
  是凸函数。  
- **例子**：  
  $ f(x) = e^{x^2} $ 是凸函数（$ h(z) = e^z $ 凸且非递减，$ g(x) = x^2 $ 凸）。

#### **(2) 向量复合**
- **定理**：若 $ h: \mathbb{R}^k \to \mathbb{R} $ 凸且关于每个分量非递减，$ g_i: \mathbb{R}^n \to \mathbb{R} $ 凸，则  
  $$
  f(x) = h(g_1(x), g_2(x), \dots, g_k(x))
  $$  
  是凸函数。  
- **例子**：  
  $ f(x) = \log(e^{x_1} + e^{x_2}) $ 是凸函数（对数-指数和）。

---

### **2.5 下确界 (Infimum)**
- **定理**：若 $ f(x, y) $ 是联合凸函数，则  
  $$
  g(x) = \inf_{y} f(x, y)
  $$  
  是凸函数（若下确界可达且不为 $-\infty$）。  
- **例子**：  
  $ f(x, y) = x^2 + y^2 $，则 $ g(x) = \inf_y f(x, y) = x^2 $ 是凸函数。

---

## **3. 特殊函数的保凸性**
### **3.1 透视函数 (Perspective Function)**
- **定义**：对凸函数 $ f: \mathbb{R}^n \to \mathbb{R} $，其透视函数为  
  $$
  g(x, t) = t f\left(\frac{x}{t}\right), \quad t > 0.
  $$  
- **性质**：$ g(x, t) $ 是凸函数。  
- **应用**：在齐次函数优化问题中常见。

---

### **3.2 共轭函数 (Conjugate Function)**
- **定义**：对凸函数 $ f $，其共轭函数为  
  $$
  f^*(y) = \sup_{x} \left( y^\top x - f(x) \right).
  $$  
- **性质**：$ f^* $ 必为凸函数（即使 $ f $ 非凸）。

---

### **3.3 分片线性函数 (Piecewise Linear Function)**
- **定义**：形如 $ f(x) = \max_{i} (a_i^\top x + b_i) $。  
- **性质**：凸函数（多个仿射函数的逐点最大值）。

---

## **4. 保凸运算的应用**
### **4.1 优化问题建模**
- **线性规划 (LP)**：目标函数和约束均为仿射函数，可行域为凸集。  
- **半定规划 (SDP)**：半正定锥约束与凸目标函数组合。

---

### **4.2 机器学习中的损失函数**
- **Hinge Loss**：$ \max(0, 1 - y x^\top w) $ 是凸函数（逐点最大值）。  
- **逻辑回归损失**：$ \log(1 + e^{-y x^\top w}) $ 是凸函数（凸函数的复合）。

---

### **4.3 经济学中的效用函数**
- **CES 效用函数**：$ U(x) = \left( \sum_{i=1}^n x_i^\rho \right)^{1/\rho} $（$ \rho \leq 1 $ 时为凹函数，负效用则为凸函数）。

---

## **5. 保凸性的直观理解**
- **几何视角**：保凸运算不破坏函数图像的“碗状”结构。  
- **代数视角**：运算不引入非凸的“凹陷”或“尖峰”。

---

## **附：关键结论**
- **保凸运算是构造复杂凸函数的工具**：通过基本凸函数和保凸运算可生成丰富的凸函数类。  
- **凸性在优化中至关重要**：保凸性确保优化问题的全局最优解和算法高效性。

---

# **复合函数的保凸条件与透视函数**

---

## **1. 复合函数的保凸条件**

复合函数 $ h(g(x)) $ 的凸性取决于外层函数 $ h $ 和内层函数 $ g $ 的凸性及单调性。以下是关键定理与示例：

### **1.1 标量复合定理**
设 $ g: \mathbb{R}^n \to \mathbb{R} $，$ h: \mathbb{R} \to \mathbb{R} $，且 $ h $ 的定义域包含 $ g $ 的值域：
- **若 $ h $ 凸且非递减，$ g $ 凸** ⇒ $ h(g(x)) $ 凸。
- **若 $ h $ 凸且非递增，$ g $ 凹** ⇒ $ h(g(x)) $ 凸。
- **若 $ h $ 凹且非递减，$ g $ 凹** ⇒ $ h(g(x)) $ 凹。
- **若 $ h $ 凹且非递增，$ g $ 凸** ⇒ $ h(g(x)) $ 凹。

#### **示例**
1. **凸外层与凸内层**：  
   $ h(z) = e^z $（凸且非递减），$ g(x) = x^2 $（凸）  
   ⇒ $ f(x) = e^{x^2} $ 凸。

2. **凸外层与凹内层**：  
   $ h(z) = -z^3 $（凹且非递增），$ g(x) = \sqrt{x} $（凹，定义域 $ x \geq 0 $)  
   ⇒ $ f(x) = -(\sqrt{x})^3 = -x^{3/2} $ 凹。

---

### **1.2 向量复合定理**
设 $ g_i: \mathbb{R}^n \to \mathbb{R} $（$ i = 1, \dots, k $），$ h: \mathbb{R}^k \to \mathbb{R} $：
- **若 $ h $ 凸且关于每个变量非递减，每个 $ g_i $ 凸** ⇒ $ h(g_1(x), \dots, g_k(x)) $ 凸。
- **若 $ h $ 凹且关于每个变量非递增，每个 $ g_i $ 凹** ⇒ 复合函数凹。

#### **示例**
$ h(z_1, z_2) = z_1 + z_2^2 $（凸且关于 $ z_1 $ 非递减，关于 $ z_2 $ 任意），  
$ g_1(x) = x $，$ g_2(x) = x^2 $（均为凸）  
⇒ $ f(x) = x + x^4 $ 凸。

---

## **2. 函数的透视 (Perspective Function)**

### **2.1 定义与保凸性**
对凸函数 $ f: \mathbb{R}^n \to \mathbb{R} $，其**透视函数**定义为：
$$
g(x, t) = 
\begin{cases} 
t \cdot f\left( \dfrac{x}{t} \right), & t > 0, \\
+\infty, & \text{否则}.
\end{cases}
$$
- **性质**：若 $ f $ 凸，则 $ g(x, t) $ 是凸函数（在定义域 $ t > 0 $ 上）。

#### **证明思路**
1. **定义域验证**：集合 $ \{(x, t) \mid t > 0\} $ 是凸集。
2. **凸性验证**：对任意 $ (x_1, t_1), (x_2, t_2) $ 和 $ \lambda \in [0,1] $，令 $ t = \lambda t_1 + (1-\lambda) t_2 $，则：
   $$
   g\left( \lambda x_1 + (1-\lambda)x_2, t \right) = t \cdot f\left( \dfrac{\lambda x_1 + (1-\lambda)x_2}{t} \right).
   $$
   利用 $ f $ 的凸性和权重的归一化，可证明不等式成立。

---

### **2.2 示例与应用**
#### **示例1：二次函数的透视**
原函数：$ f(x) = \dfrac{1}{2}x^\top Q x $（$ Q \succeq 0 $），  
透视函数：
$$
g(x, t) = t \cdot \dfrac{1}{2} \left( \dfrac{x}{t} \right)^\top Q \left( \dfrac{x}{t} \right) = \dfrac{1}{2} \dfrac{x^\top Q x}{t}.
$$
- **应用**：在资源分配问题中建模成本与时间的关系。

#### **示例2：负熵的透视**
原函数：$ f(x) = x \log x $（定义域 $ x > 0 $），  
透视函数：
$$
g(x, t) = t \cdot \dfrac{x}{t} \log \dfrac{x}{t} = x \log \dfrac{x}{t} - x \log t.
$$
- **应用**：信息论中的缩放熵优化。

---

### **2.3 几何解释**
透视函数将原函数 $ f(x) $ 沿 $ t $-轴进行缩放，保持齐次性。例如：
- 当 $ t = 1 $ 时，$ g(x, 1) = f(x) $。
- 当 $ t \to 0^+ $，函数值趋向于原函数在无穷远处的行为。

---

## **3. 总结**

### **复合函数保凸的关键条件**
| **外层函数 $ h $** | **内层函数 $ g $** | **复合函数 $ h(g(x)) $** |
|-----------------------|-----------------------|----------------------------|
| 凸，非递减            | 凸                    | 凸                         |
| 凸，非递增            | 凹                    | 凸                         |
| 凹，非递减            | 凹                    | 凹                         |
| 凹，非递增            | 凸                    | 凹                         |

### **透视函数的保凸性**
- 原函数凸 ⇒ 透视函数凸。
- 应用广泛于齐次性优化问题，如资源缩放、几何规划等。

---

## **4. 练习**
1. **验证复合函数凸性**：  
   设 $ h(z) = \log(1 + e^z) $（凸且非递减），$ g(x) = \|x\|_2 $（凸），证明 $ f(x) = \log(1 + e^{\|x\|_2}) $ 是凸函数。
2. **透视函数计算**：  
   对 $ f(x) = \|x\|_1 $，求其透视函数 $ g(x, t) $，并验证凸性。
3. **反例构造**：  
   给出一个外层函数凸但复合函数非凸的例子，说明原因。

---

# **复合函数的保凸条件、共轭函数与拟凸函数**

---

## **1. 复合函数的保凸条件**

### **1.1 标量复合函数**
设 $ g: \mathbb{R}^n \to \mathbb{R} $，$ h: \mathbb{R} \to \mathbb{R} $，复合函数 $ f(x) = h(g(x)) $ 的凸性由以下规则决定：

- **规则 1**：若 $ h $ 是凸函数且非递减，$ g $ 是凸函数 ⇒ $ f $ 是凸函数。
- **规则 2**：若 $ h $ 是凸函数且非递增，$ g $ 是凹函数 ⇒ $ f $ 是凸函数。
- **规则 3**：若 $ h $ 是凹函数且非递减，$ g $ 是凹函数 ⇒ $ f $ 是凹函数。
- **规则 4**：若 $ h $ 是凹函数且非递增，$ g $ 是凸函数 ⇒ $ f $ 是凹函数。

#### **示例**
1. **凸函数复合**：  
   $ h(z) = e^z $（凸且非递减），$ g(x) = x^2 $（凸）  
   ⇒ $ f(x) = e^{x^2} $ 是凸函数。  
2. **凹函数复合**：  
   $ h(z) = \sqrt{z} $（凹且非递减），$ g(x) = -\|x\|_2 $（凹）  
   ⇒ $ f(x) = \sqrt{-\|x\|_2} $ 无定义（需注意值域匹配）。

---

### **1.2 向量复合函数**
设 $ g_i: \mathbb{R}^n \to \mathbb{R} $（$ i = 1, \dots, k $），$ h: \mathbb{R}^k \to \mathbb{R} $，则 $ f(x) = h(g_1(x), \dots, g_k(x)) $ 的凸性由以下规则决定：
- **规则**：若 $ h $ 是凸函数且对每个分量非递减，每个 $ g_i $ 是凸函数 ⇒ $ f $ 是凸函数。

#### **示例**
$ h(z_1, z_2) = z_1 + z_2^2 $（凸且关于 $ z_1 $ 非递减），  
$ g_1(x) = x $，$ g_2(x) = x^2 $（均为凸）  
⇒ $ f(x) = x + x^4 $ 是凸函数。

---

## **2. 函数的共轭（Fenchel共轭）**

### **2.1 定义**
对函数 $ f: \mathbb{R}^n \to \mathbb{R} $，其**共轭函数** $ f^*: \mathbb{R}^n \to \mathbb{R} \cup \{+\infty\} $ 定义为：  
$$
f^*(y) = \sup_{x \in \text{dom}(f)} \left( y^\top x - f(x) \right).
$$

### **2.2 性质**
1. **凸性**：无论 $ f $ 是否凸，$ f^* $ 必为凸函数（上确界的仿射函数族）。  
2. **双对合性**：若 $ f $ 是闭凸函数，则 $ f^{**} = f $。  
3. **几何解释**：$ f^*(y) $ 是 $ f(x) $ 在方向 $ y $ 上的最大支撑超平面截距。

### **2.3 例子**
1. **仿射函数**：  
   $ f(x) = a^\top x + b $ ⇒ $ f^*(y) = \begin{cases} -b, & y = a, \\ +\infty, & \text{其他}. \end{cases} $
2. **二次函数**：  
   $ f(x) = \frac{1}{2}x^\top Q x $（$ Q \succ 0 $）⇒ $ f^*(y) = \frac{1}{2} y^\top Q^{-1} y $.  
3. **绝对值函数**：  
   $ f(x) = |x| $ ⇒ $ f^*(y) = \begin{cases} 0, & |y| \leq 1, \\ +\infty, & \text{其他}. \end{cases} $

---

## **3. α-Sublevel Set 与拟凸函数**

### **3.1 α-下水平集（α-Sublevel Set）**
对函数 $ f: \mathbb{R}^n \to \mathbb{R} $，其 α-下水平集定义为：  
$$
S_\alpha = \{ x \in \text{dom}(f) \mid f(x) \leq \alpha \}.
$$
- **性质**：若 $ f $ 是凸函数，则所有 $ S_\alpha $ 均为凸集（反之不一定成立）。

### **3.2 拟凸函数（Quasiconvex Function）**
- **定义**：若对任意 $ \alpha \in \mathbb{R} $，其 α-下水平集 $ S_\alpha $ 均为凸集，则称 $ f $ 为拟凸函数。  
- **与凸函数的关系**：  
  - 凸函数 ⇒ 拟凸函数，但拟凸函数不一定是凸函数。  
  - **例子**：  
    - $ f(x) = \sqrt{|x|} $ 是拟凸但非凸函数。  
    - $ f(x) = x^3 $ 在 $ x \in \mathbb{R} $ 上不是拟凸函数（下水平集非凸）。

### **3.3 拟凸函数的判定**
- **一阶条件**（可微函数）：若 $ f $ 可微且满足：  
  $$
  f(y) \leq f(x) \implies \nabla f(x)^\top (y - x) \leq 0,
  $$  
  则 $ f $ 是拟凸函数。  
- **应用**：拟凸函数在经济学（效用函数）和几何优化中常见。

---

## **4. 总结对比**

| **概念**          | **定义/性质**                                                                 | **示例**                     |
|--------------------|-----------------------------------------------------------------------------|------------------------------|
| **复合函数保凸**   | 外层函数的凸性与单调性决定复合结果。                                            | $ e^{x^2} $, $ x + x^4 $ |
| **共轭函数**       | 上确界定义，必为凸函数；反映原函数的支撑超平面。                                  | $ f(x) = |x| $ 的共轭       |
| **拟凸函数**       | 所有下水平集为凸集，但函数本身未必凸。                                            | $ \sqrt{|x|} $             |
| **α-下水平集**     | 凸函数的下水平集必凸，拟凸函数定义依赖于此性质。                                  | 凸函数的 $ S_\alpha $       |

---

## **5. 练习**
1. **验证共轭函数**：计算 $ f(x) = -\log(x) $（定义域 $ x > 0 $）的共轭函数 $ f^*(y) $。  
2. **拟凸性分析**：证明 $ f(x) = \frac{x}{1 + x^2} $ 是拟凸函数。  
3. **复合函数判定**：设 $ h(z) = \log(z) $，$ g(x) = \|x\|_2 $，分析 $ f(x) = h(g(x)) $ 的凸性。

---

## 有约束优化问题

$$
\begin{cases}
    \min_x f(x), \\
    s.t. Ax = b
\end{cases}
$$

KKT

$$
\begin{cases}
    Ax^* = b, \\
    \nabla f(x^*) + A^T v^* = 0
\end{cases}
$$

## 拉格朗日乘子法（Lagrangian Method）（Method of Lagrange Mvltiplier）

参考 Bertsekas

给定更新公式如下：

1. $ x^{k+1} = x^k - \alpha^k \left( \nabla f(x^k) + A^T v^k \right) $
2. $ v^{k+1} = v^k + \alpha^k \left( A x^{k} - b \right) $

$ \alpha ^ k $ 是一个递增的序列。

从鞍点的角度解释：

凸问题且对偶间隙等于0，拉格朗日函数的鞍点就是kkt的最优解。

原问题的拉格朗日函数：

$ L(x, v) = f(x) + v^T (A x - b) $

鞍点

1. $ (x^*, v^*) = \arg \max_v \min_x L(x, v) $
2. $ (x^*, v^*) = \arg \min_x \max_v L(x, v) $

prime或dual最优解已知，求另一个问题的解：

$$
x^* = \arg \min_x L(x, v^*)
$$

$$
v^* = \arg \max_v L(x^*, v)
$$

假设知道的dual问题的最优解，则在 $ x_k $ , 负梯度方向：

$$
- \nabla f(x^k) - A^T v^*
$$

更新公式：

$$
x^{k+1} = x^k + \alpha ( - \nabla f(x^k) - A^T v^* )
$$

但是 $ v^* $ 未知，所以用 $ v^k $ 替代，得到了拉格朗日乘子法的公式1.

假设知道的 prime 问题的最优解，则在 $ v_k $ , 负梯度方向：

$$
- A x^* + b
$$

更新公式(max问题，梯度上升)：

$$
v^{k+1} = v^k + \alpha^k \left( A x^* - b \right)
$$

但是 $ x^* $ 未知，所以用 $ x^k $ 替代，得到了拉格朗日乘子法的公式2.

核心思想就是求拉格朗日函数的鞍点。

从另一个角度求KKT的解，定义优化问题：

$$
\min p(x, v) = \frac{1}{2} \| Ax - b \|^2_2 + \frac{1}{2} \| \nabla f(x) + A^Tv \|^2_2
$$

KKT 的解一定是这个优化问题的最优解，从负梯度的方向优化这个问题，负梯度：

$$
-\begin{pmatrix}
    A^T ( Ax - b ) + \nabla^2f(x)( \nabla f(x) + A^Tv ) \\
    A (\nabla f(x) + A^Tv)
\end{pmatrix}
$$

拉格朗日乘子法的负梯度方向是：

$$
-\begin{pmatrix}
    \nabla f(x) + A^Tv\\
    -A^Tx + b
\end{pmatrix}
$$

这两个梯度方向的点积是大于0的：

$$
(\nabla f(x) + A^Tv)^T（A^T (Ax - b) + \nabla^2f(x) (\nabla f(x) + A^Tv) + \\
(-A^Tx + b)^T (A (\nabla f(x) + A^Tv)) = \\ （\nabla f(x) + A^Tv）\nabla^2f(x) (\nabla f(x) + A^Tv)
$$

结合KKT条件我们知道，除了在鞍点，以下条件不会同时满足：

$$
\begin{cases}
    \nabla f(x) + A^Tv = 0 \\
    \nabla^2 f(x) > 0
\end{cases}
$$

所以，拉格朗日乘子法的负梯度方向确实是下降方向，因为和负梯度方向夹锐角。

所以，可以通过对alpha进行线搜索。但是p经常是非凸的。经常我们会将alpha定义成有上线的递增序列。

拉格朗日方法的缺点：

- 解不稳定
- 慢

引出增广拉格朗日法。

## 增广拉格朗日法

$$
L_c(x, v) = f(x) + v^T(Ax-b) + \frac{c}{2} \|Ax-b\|^2_2
$$

这两个问题的 prime dual 最优解是等价的。

$$
\begin{cases}
    \min f(x) + \frac{c}{2} \|Ax-b\|^2_2 \\
    s.t. Ax = b
\end{cases}
$$

$$
\begin{cases}
    \min f(x) \\
    s.t. Ax = b
\end{cases}
$$

更新公式：

$$
\begin{matrix}
    x^{k+1} = \argmin_x {L_c(x, v^k)}\\
    v^{k+1} = v^k + c (Ax^{k+1} - b)
\end{matrix}
$$

性质：

- 如果 $v=v^*$ ，则 $\forall c > 0, x^* = \argmin_x L_c(x, v^*)$
- 如果 $c\rightarrow +\infty$，则 $\forall v, x^* = \argmin_x L_c(x,v)$

增广拉格朗日法的难点在于更新 $x^{k+1}$ 的过程，但是$x^{k+1}$不需要求解的非常精确，通常也可以收敛。

例子： $ f(x) g(x) $ 都是凸函数

$$
\begin{matrix}
    \min_x f(x) + g(x) \\
    \iff \begin{matrix}
        \min_x f(x) + g(z) \\
        s.t. x = z
    \end{matrix}
\end{matrix}
$$

如果采用增广拉格朗日法，则有：

$$
\begin{matrix}
    {x^{k+1}, z^{k+1}} = \argmin_{x,z} {f(x) + g(z) + {v^k}^T(x-z) + \frac{c}{2} \| x-z\|^2_2} \\
    v^{k+1} = v^{k} + c(x^{k+1} - z^{k+1})
\end{matrix}
$$

坐标轮换法

- 多步迭代，分解成子问题，简化求解的过程。
- $x^{k+1}$不需要求解的非常精确，通常也可以收敛。

## 交替方向乘子法 （Alternating Direction Method of Multipler）

$$
\begin{matrix}
    &\text{(1a) } x^{k+1|t+1} = \argmin_x {f(x) + \frac{c}{2} \| x - z^{k+1|t} + \frac{v^k}{c}\|^2_2} \\
    &\text{(1b) } z^{k+1|t+1} = \argmin_z {g(z) + \frac{c}{2} \| z - x^{k+1|t+1} + \frac{v^k}{c}\|^2_2} \\
    &\text{(2)  } v^{k+1} = v^{k} + c(x^{k+1} - z^{k+1})
\end{matrix}
$$

- 如果按照增广拉格朗日法的迭代过程，需要两层for循环，1a和1b需要迭代收敛，再迭代2。
- 但是如果f和g都是凸的，那么按照1a 1b 2 的顺序迭代也可以收敛。
