# LookOut: Diverse Multi-Future Prediction and Planning for Self-Driving

## 摘要

在本文中，我们提出了LOOKOUT，一个新颖的自主系统，通过感知环境，预测多种未来场景的可能性，并通过在这些未来实现上优化应急计划来估计自驾车（SDV）的轨迹。具体而言，我们学习了一个多代理未来轨迹的多样联合分布，涵盖了未来多种模式，并利用生成模型的表达能力，实现了高样本效率。与之前的多样化运动预测工作不同，我们的多样性目标明确奖励采样那些需要自驾车作出不同反应的未来情景，以提高安全性。我们的应急规划器随后在这些未来场景中找到既舒适又不保守的轨迹，以确保安全应对广泛的未来情境。通过广泛的评估，我们表明，在大规模自驾数据集上，我们的模型在运动预测方面显示出了显著更高的多样性和样本效率，同时在长期闭环仿真中，表现出比当前最先进模型更安全且不那么保守的运动规划。

## 引言

自动驾驶车辆（SDV）有潜力大大提高我们道路的安全性，因为与人类不同，它们能够在驾驶过程中持续扫描周围环境，而不会受到分心或影响。自动驾驶车辆成功的关键在于其感知周围环境并预测交通参与者未来轨迹的能力，特别是那些可能影响其决策的参与者。这些预测随后被运动规划模块利用，以规划一个安全且舒适的机动以达到目标。

预测交通参与者的行为非常具有挑战性，因为人类并不总是遵守交通规则，有时还会表现出异常行为。此外，场景可能会以多种方式展开，这取决于参与者之间的互动（例如，在合流时，参与者A可能让路给参与者B，或者反之）。尽管大多数工作独立地预测每个参与者的未来【11，10，29，8，4】，但最近的方法通过建模参与者间的互动，可以产生解释整个场景的一致样本【2，33，38，5】。然而，这些方法需要大量样本来覆盖分布的长尾部分。这个问题是严重的，因为这些长尾部分对安全至关重要，未能考虑它们可能会导致事故（例如，一个受损的驾驶员闯红灯，垂直于SDV的预定轨迹）。因此，迫切需要开发能够高效采样多种可能未来的预测系统。不幸的是，现有的方法【46，47】并不高效，因为它们简单地鼓励在欧几里得空间中增加多样性，因此利用样本来覆盖那些不影响SDV行为的无关参与者或动作。

此外，现有的运动规划器无法利用那些生成一致场景样本的预测系统【53，13，1，36】。相反，它们通过独立地采样每个参与者的边际分布来优化预期成本，从而忽视了这些未来场景中的一些不可能同时发生的情况（例如，在四向停车站，水平或垂直方向的交通流动只能有一个）。这些规划器还假设SDV必须承诺一个单一的长期轨迹，而实际上它可以执行一个短期动作，并在新传感器观测数据可用时重新规划。因此，它们会导致次优且过于保守的轨迹【50，39】，例如，SDV为应对一个不太可能发生的未来情境而过早刹车，而不是在安全停车的条件下尽可能保持车速。

在本文中，我们提出了LOOKOUT，一个完整的端到端自主系统，它能够检测场景中的参与者，预测高样本效率的多样化一致性未来集，并规划一个能够应对潜在危险的防御性动作，同时不会对未来远期低概率的危险作出过度反应。特别地，为了解决运动预测中样本效率低和模式覆盖不足的问题，我们将这一任务形式化为一个多样集预测问题，其中集合中的每个元素反映了场景级别的一个可能未来。为了使这个集合覆盖那些对我们决策至关重要的未来模式，我们直接优化下游自车运动规划的多样性。然后，场景评分模块估算集合中每个未来场景的概率，使我们的规划器能够考虑到不太可能但至关重要的场景，同时避免过度保守。最后，我们提出了一种新颖的应急规划器，它能够通过为每个未来单独规划长期反应，同时共享一个相对于这些未来不保守并避免立即碰撞的短期动作，从而利用多个一致的未来。图1展示了两个多样化未来的例子以及对应的共享动作和应急计划。