# Latent Belief Space Motion Planning under Cost, Dynamics, and Intent Uncertainty

## 摘要

自主代理在观察世界状态时存在一定的限制。部分可观察的马尔可夫决策过程（POMDP）可以建模在世界状态不确定性下的规划问题，但带有多模态信念、连续动作和非线性动态的POMDP在机器人应用中较为难解。本文提出了一种动态规划算法，用于在具有连续状态、动作、观察和非线性动态的POMDP中，在离散潜在状态的信念空间中进行规划。与假设高斯不确定性的传统信念空间运动规划方法不同，我们的方法构建了一种新的树状结构表示可能的观察和多模态信念空间轨迹，并在此结构上优化应急计划。我们将此方法应用于存在奖励或成本函数不确定性（例如目标或障碍物的配置）、动态不确定性以及其他代理行为由潜在意图决定的交互性不确定性的问题。通过三个实验，证明我们的算法在不确定性规划方面超越了强基准方法，并且在自动变道任务中的实验结果表明我们的算法能够合成出稳健的交互轨迹。

## 引言

由于自主代理在观察世界状态时的能力有限，如何在不确定性条件下进行有效规划是一个至关重要的问题。噪声执行器、不完美的传感器以及遮挡等感知限制会导致代理在决策时面临不确定性。即便在拥有完美传感器和感知的情况下，世界的潜在状态也可能依然不透明，例如，下一街区是否有空停车位，或其他驾驶员是否打算让行。如何在这种不确定性下进行规划，需要在探索性动作的成本与获取信息的潜在收益之间进行权衡。然而，部分可观察的规划问题，通常可以形式化为部分可观察的马尔可夫决策过程（POMDP），但通常是不可解的【1】。

轨迹优化技术已经证明在机器人应用中非常有效【2】【3】，但通常需要状态是完全可观察的（或单独估计的）。将轨迹优化扩展到信念空间规划使得部分可观察性能够在适用于连续非线性机器人系统的运动规划算法中得到体现【4】【5】。然而，这些方法主要考虑的是单峰高斯不确定性，这限制了它们在多模态结构问题中的应用。现实世界中的不确定性通常是多模态的：例如，在自动驾驶中，存在关于被遮挡或超出传感器范围的车辆状态的不确定性，关于车辆及其组件的功能模式的不确定性，关于环境状态的不确定性，以及关于其他驾驶员的特征、意图和信念的不确定性。多模态结构可以通过通用的POMDP表示，这可以通过通用求解器求解【6】【7】。然而，为运动规划优化连续动作是当今POMDP求解器面临的挑战。

在本文中，我们提出了一种轨迹优化方法，用于解决带有离散潜在变量的非高斯信念的非线性、连续状态、动作和观察的POMDP问题。我们的方法称为部分可观察的微分动态规划（PODDP），它构建并优化一个应急计划，覆盖可能的观察和轨迹的树形结构。我们推导了在轨迹树上进行动态规划的技术，这包括通过观察和贝叶斯信念更新传播近似价值函数。最后，我们描述了一个实际的分层动态规划分解方法，极大地提高了我们方法的效率。

PODDP解决了几个重要类别的非线性连续规划问题，这些问题具有离散潜在状态的不确定性：（1）任务的成本函数依赖于不确定的潜在状态，例如，代理必须接近或避免可能位于有限位置的目标或障碍物；（2）任务的动态受系统的不确定潜在模式条件限制，例如，接触模式、组件状态或环境条件（例如，平坦与崎岖地形）；（3）交互任务，其中其他代理的轨迹施加动态成本，并且受其潜在意图的影响，例如，自动驾驶系统必须在不确定其他车辆交互轨迹的情况下进行规划，这些轨迹是基于其驾驶员的情境意识水平、合作意图等条件的。

我们通过每个问题类别的实例实验展示了该方法的有效性。我们将我们的算法与两个强基准进行了比较：1）一个“完全可观察”的基准，其中DDP将最大似然状态视为真实世界状态，并进行标准DDP规划；2）一个基准，将多个潜在状态假设结合在成本函数中，并根据它们的概率加权。最后，我们考虑了一个具有挑战性的自动驾驶设置，在该设置中模型必须规划交互式变道轨迹，并显示PODDP能够通过推断其他代理是否打算让行来规划并执行成功的变道轨迹。