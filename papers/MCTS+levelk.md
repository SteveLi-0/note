# Receding Horizon Motion Planning for Automated Lane Change and Merge Using Monte Carlo Tree Search and Level-K Game Theory

## 摘要

在自动驾驶中，运动规划和预测周围环境的未来状态是主要挑战之一。在变道和并线操作中，预测邻近车辆在未来的反应尤为重要，尤其是在缺乏车间通信（如V2V、V2X等）的情况下。现有的人类驾驶模型、概率方法、基于规则的技术和机器学习方法对此问题有所涉及，但未完全聚焦于车辆的行为特征。此外，预测框架还需能够快速向路径规划器提供未来状态的估计。构建一个能够快速考虑车辆间交互的结构是本研究的主要动机。在本文中，我们提出了一种基于蒙特卡罗树搜索（MCTS）的快速递归预测算法，用于高速公路场景中的实时路径规划。该算法受到最新研究成果的启发，采用层级K游戏理论框架来预测周围车辆的策略。仿真结果显示，该方法具备快速计算的良好效果。

## 引言

近年来，变道和并线操作在自动驾驶领域引起了广泛关注。主要挑战在于如何在不影响交通流畅的情况下，安全、舒适地执行这些操作。这一问题的难点在于，周围车辆的未来意图通常未知，同时路径规划在计算上也非常复杂，因为需要在非凸的可行域中进行规划，并且需满足多种硬性和软性约束。本文的主要目标是开发一种能够实时实现的运动规划算法，该算法能够通过博弈论方法考虑与邻近车辆的交互。

在多车可能发生碰撞的场景中，一条成功的轨迹不仅能够避免碰撞，还需考虑能耗效率和操作时长。通过递归预测方式，可以利用周围环境的更多信息，从而提升规划轨迹的安全性和最优性。一种常见的获取这些信息的方法是通过代理间的通信。然而，尽管通信方法在自动驾驶中已展示出较好的效果，通信丢失、延迟或网络攻击可能会导致不良后果。此外，在可预见的未来，很难确保所有周围车辆都具备联网能力。在缺乏通信的情况下，可使用人类驾驶行为的解析模型（如MOBIL模型）或概率模型，也可以应用机器学习和人工智能技术来应对有其他代理存在的路径规划问题。然而，这些方法在复杂性、计算成本以及所需的大量训练和验证数据方面都面临挑战。

为降低计算复杂度，本文提出使用蒙特卡罗树搜索（MCTS）在高速公路场景中寻找接近最优的车辆轨迹。受到最新研究成果的启发，我们采用层级K博弈论来根据其他车辆的策略深度预测其轨迹。在其他研究中，Li等人结合层级K方法和强化学习，创建了一个框架用于不确定环境中的预测和运动规划。类似方法还被应用于无信号交叉口等其他场景。

蒙特卡罗树搜索（MCTS）是一种将蒙特卡罗方法与游戏树搜索相结合的随机采样搜索技术，常用于处理状态空间部分可观测的策略性游戏，如《吃豆人》、《围棋》和《Kriegspiel》等。这类场景的不确定性使决策变得更加困难，特别是在需要快速决策时。MCTS通过模拟大量可能的策略并系统性地评估它们的结果，最终选择由代理执行的最佳动作。

在多代理环境中，每个代理都在选择一系列最优动作（即策略）来实现某些目标，这种环境下每个代理的动作都会影响其他代理。例如，在高速公路驾驶场景中，车辆之间的碰撞是一个主要关注点。预测每个参与代理在一段时间内的动作序列，并在自车的采样过程中结合这种预测，有助于减少冲突互动的可能性。在整合层级K博弈论时，原则上每个路径规划器都假设与其交互的驾驶者具备较低层次的策略能力，并利用蒙特卡罗树搜索（MCTS）预测并评估这些驾驶者在规划周期内的可能动作序列。最终，规划器执行另一轮MCTS，以在考虑其他代理预测动作的基础上找到符合约束条件的自车轨迹。

本文的其余部分组织如下：第二节A部分描述了用于捕捉车辆动力学的动态模型以及动作空间。第二节B部分介绍了奖励函数的定义。第三节详细介绍了蒙特卡罗树搜索（MCTS），第四节则阐述了层级K博弈论及其与MCTS的整合。第五节展示了仿真结果，最后在第六节给出了结论。